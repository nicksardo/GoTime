(function(){window.GoTime=function(){class t{constructor(){return t._setupSync(),new Date(t.now())}static _setupSync(){var n,e,s,a;if(!1===t._synchronizing){for(t._synchronizing=!0,n=0,e=(s=t._syncInitialTimeouts).length;n<e;n++)a=s[n],setTimeout(t._sync,a);setInterval(t._sync,t._syncInterval)}}static now(){return Date.now()+t._offset}static getOffset(){return t._offset}static getPrecision(){return t._precision}static getLastMethod(){return t._lastSyncMethod}static getSyncCount(){return t._syncCount}static getHistory(){return t._history}static setOptions(n){return null!=n.AjaxURL&&(t._ajaxURL=n.AjaxURL),null!=n.SyncInitialTimeouts&&(t._syncInitialTimeouts=n.SyncInitialTimeouts),null!=n.SyncInterval&&(t._syncInterval=n.SyncInterval),null!=n.OnSync&&(t._onSyncCallback=n.OnSync),null!=n.WhenSynced&&(t._firstSyncCallback=n.WhenSynced),t._setupSync()}static wsSend(n){return t._wsCall=n}static wsReceived(n){var e,s,a;return e=Date.now(),a=t._dateFromService(n),s=t._calculateOffset(t._wsRequestTime,e,a),t._reviseOffset(s,"websocket")}static _ajaxSample(){var n,e;return(n=new XMLHttpRequest).open("GET",t._ajaxURL),n.onreadystatechange=function(){var s,a,c;s=Date.now(),4===n.readyState&&200===n.status&&(c=t._dateFromService(n.responseText),a=t._calculateOffset(e,s,c),t._reviseOffset(a,"ajax"))},e=Date.now(),n.send(),!0}static _sync(){null!=t._wsCall&&(t._wsRequestTime=Date.now(),t._wsCall())?t._syncCount++:null!=t._ajaxURL&&t._ajaxSample()&&t._syncCount++}static _calculateOffset(t,n,e){var s;return{offset:e-t-(s=(n-t)/2),precision:s}}static _reviseOffset(n,e){var s;if(!isNaN(n.offset)&&!isNaN(n.precision))return s=t.now(),t._lastSyncTime=s,t._lastSyncMethod=e,t._history.push({Sample:n,Method:e,Time:s}),n.precision<=t._precision&&(t._offset=Math.round(n.offset),t._precision=n.precision),t._firstSyncCallbackRan||null==t._firstSyncCallback?null!=t._onSyncCallback?t._onSyncCallback(s,e,n.offset,n.precision):void 0:(t._firstSyncCallbackRan=!0,t._firstSyncCallback(s,e,n.offset,n.precision))}static _dateFromService(t){return new Date(parseInt(t))}}return t._syncCount=0,t._offset=0,t._precision=Infinity,t._history=[],t._syncInitialTimeouts=[0,3e3,9e3,18e3,45e3],t._syncInterval=9e5,t._synchronizing=!1,t._lastSyncTime=null,t._lastSyncMethod=null,t._ajaxURL=null,t._ajaxSampleSize=1,t._firstSyncCallbackRan=!1,t._firstSyncCallback=null,t._onSyncCallback=null,t._wsCall=null,t._wsRequestTime=null,t}.call(this)}).call(this);
